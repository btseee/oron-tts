# OronTTS RunPod Training Configuration
# Container: runpod/pytorch:2.4.0-py3.11-cuda12.4.1-devel-ubuntu22.04
# Hardware: RTX 4090 24GB, 16 vCPU, 62GB RAM, 50GB Disk

# Audio Settings
sample_rate: 22050
n_fft: 1024
hop_length: 256
win_length: 1024
n_mels: 80
fmin: 0.0
fmax: 8000.0

# Training Settings (RTX 4090 24GB VRAM)
# Optimized for training from scratch - prioritizes stability
batch_size: 12  # Reduced for stability
num_epochs: 1500
learning_rate: 0.0002
betas: [0.8, 0.99]
eps: 1.0e-8  # Larger epsilon for numerical stability
lr_decay: 0.9995  # Slower decay
segment_size: 32
fp16: false  # Disable FP16 for stability when training from scratch
num_workers: 8
log_interval: 50
save_interval: 5  # Save more frequently
grad_accumulation_steps: 2
prefetch_factor: 4
pin_memory: true
use_tqdm: false  # Disable tqdm for cleaner RunPod container logs

# Stability Settings (critical for training from scratch)
disc_warmup_steps: 2000  # Skip discriminator training for first N steps
max_grad_norm: 0.5  # Aggressive gradient clipping
grad_clip_value: 3.0  # Clip individual gradient values

# Loss Weights (balanced for stable training)
loss_weight_mel: 1.0
loss_weight_kl: 0.1  
loss_weight_dur: 1.5      
loss_weight_fm: 2.0     
loss_weight_gen: 3.0  

# CUDA 12.4 / PyTorch 2.4.0 Optimizations
compile_model: false  # Disable for stability during initial training
cudnn_benchmark: true
use_tf32: true  # TensorFloat-32 for Ampere+

# Model Settings
model:
  inter_channels: 192
  hidden_channels: 192
  filter_channels: 768
  n_heads: 2
  n_layers: 6
  kernel_size: 3
  p_dropout: 0.1
  resblock: "1"
  resblock_kernel_sizes: [3, 7, 11]
  resblock_dilation_sizes: [[1, 3, 5], [1, 3, 5], [1, 3, 5]]
  upsample_rates: [8, 8, 2, 2]
  upsample_initial_channel: 512
  upsample_kernel_sizes: [16, 16, 4, 4]
  gin_channels: 256
  use_sdp: true

# Dataset Settings
data:
  min_audio_length: 0.5
  max_audio_length: 15.0
  min_text_length: 2
  max_text_length: 500
