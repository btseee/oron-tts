{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Install Dependencies",
            "type": "shell",
            "command": "${workspaceFolder}/.venv/bin/pip install -e '.[dev]'",
            "group": "build",
            "problemMatcher": []
        },
        {
            "label": "Lint (Ruff)",
            "type": "shell",
            "command": "${workspaceFolder}/.venv/bin/ruff check src/ scripts/",
            "group": "test",
            "problemMatcher": {
                "owner": "ruff",
                "fileLocation": ["relative", "${workspaceFolder}"],
                "pattern": {
                    "regexp": "^(.+):(\\d+):(\\d+): (\\w+) (.+)$",
                    "file": 1,
                    "line": 2,
                    "column": 3,
                    "code": 4,
                    "message": 5
                }
            }
        },
        {
            "label": "Format (Ruff + isort)",
            "type": "shell",
            "command": "${workspaceFolder}/.venv/bin/ruff format src/ scripts/ && ${workspaceFolder}/.venv/bin/isort src/ scripts/",
            "group": "build",
            "problemMatcher": []
        },
        {
            "label": "Prepare Dataset (Local CV)",
            "type": "shell",
            "command": "${workspaceFolder}/.venv/bin/python scripts/prepare.py --output-dir data/processed --dataset common-voice --max-samples 500",
            "group": "build",
            "problemMatcher": []
        },
        {
            "label": "Train (Local)",
            "type": "shell",
            "command": "${workspaceFolder}/.venv/bin/python scripts/train.py --config configs/vits_local.yaml --data-dir data/processed",
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "problemMatcher": [],
            "isBackground": true
        },
        {
            "label": "TensorBoard",
            "type": "shell",
            "command": "${workspaceFolder}/.venv/bin/tensorboard --logdir logs --bind_all",
            "group": "none",
            "isBackground": true,
            "problemMatcher": []
        },
        {
            "label": "Clean Build Artifacts",
            "type": "shell",
            "command": "find . -type d -name '__pycache__' -exec rm -rf {} + 2>/dev/null; find . -type d -name '*.egg-info' -exec rm -rf {} + 2>/dev/null; rm -rf .ruff_cache build dist",
            "group": "build",
            "problemMatcher": []
        }
    ]
}
